# !/bin/bash
ruby_commit_hash=$RUBY_COMMIT_HASH
cd ruby

git fetch origin
git rebase origin/trunk

if [ ! $ruby_commit_hash ]; then
  echo "Running benchmarks using Ruby commit $ruby_commit_hash"
  git reset --hard $ruby_commit_hash
else
  echo "Running benchmarks using lastest Ruby commit"
fi

autoconf
./configure
make
make install
rbenv global system

gem install faraday

cd / && mv driver.rb ruby/benchmark/driver.rb
